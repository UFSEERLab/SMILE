<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SMILE">
<title>add_vax • SMILE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="add_vax">
<meta property="og:description" content="SMILE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SMILE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/add_vax.html">add_vax</a>
    <a class="dropdown-item" href="../articles/epi2024.html">epi2024</a>
    <a class="dropdown-item" href="../articles/main_function.html">main_function</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>add_vax</h1>
            
      
      
      <div class="d-none name"><code>add_vax.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ufseerlab.github.io/SMILE/" class="external-link">SMILE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span></code></pre></div>
<p>We incorporate vaccination into the model as a term that modifies the
probability of survival, in other words, it modifies the fraction of the
population that moves from the infected compartment to the immune
compartment, instead of dying and becoming LIZ. The purpose of
vaccination is to enable the host to fight off the infection, and by
preventing death, we also reduce the number of infective particles
becoming available in the environment. The parameters associated to
vaccination describe the survival curve offered by herd immunity. The
parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> define a logistic curve for which
different population-level vaccination rates translate to different
survival probabilities. These parameters are associated to the host’s
natural immunity to the pathogen, and the vaccine’s effectiveness.</p>
<p>As a simple exercise, we can consider a population over the course of
10 years, where the vaccination rate is held constant. In the case of a
constant vaccination rate, we are essentially keeping survival
probability constant over the course of the simulation.</p>
<p>First, we set our parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># base parameters</span></span>
<span><span class="va">my_years</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">my_tau</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">my_theta</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># seasonal forcing parameters</span></span>
<span><span class="va">my_b_fixed</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">my_b0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">30</span></span>
<span><span class="va">my_b1</span> <span class="op">&lt;-</span> <span class="fl">0.85</span></span>
<span><span class="va">my_outbreak_period</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">*</span><span class="fl">52</span></span>
<span></span>
<span><span class="co"># vaccination parameters</span></span>
<span><span class="va">my_zeta_no_vax</span> <span class="op">&lt;-</span> <span class="fl">0.88</span> <span class="co"># survival no vaccination</span></span>
<span><span class="va">my_fixed_vax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">my_years</span><span class="op">)</span> <span class="co"># fixed vaccination</span></span>
<span><span class="va">my_yearly_vax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">my_years</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># random vaccination rates by year</span></span>
<span><span class="va">my_beta0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">5</span></span>
<span><span class="va">my_beta1</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/smile_main.html">smile_main</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="va">my_b0</span>, b1 <span class="op">=</span> <span class="va">my_b1</span>, period <span class="op">=</span> <span class="va">my_outbreak_period</span>,</span>
<span>           theta <span class="op">=</span> <span class="va">my_theta</span>, tau <span class="op">=</span> <span class="va">my_tau</span>, years <span class="op">=</span> <span class="va">my_years</span>,</span>
<span>           vax <span class="op">=</span> <span class="va">my_fixed_vax</span>, beta_0 <span class="op">=</span> <span class="va">my_beta0</span>, beta_1 <span class="op">=</span> <span class="va">my_beta1</span>, output_df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">fixed_vax_sim</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fixed_vax_sim</span><span class="op">)</span></span>
<span><span class="co">#&gt;   week    S M I L        E   Z</span></span>
<span><span class="co">#&gt; 1    1 5000 0 0 1 1.000000 0.5</span></span>
<span><span class="co">#&gt; 2    2 5000 0 0 0 1.986800 0.5</span></span>
<span><span class="co">#&gt; 3    3 5000 0 0 0 1.960574 0.5</span></span>
<span><span class="co">#&gt; 4    4 5000 0 0 0 1.934695 0.5</span></span>
<span><span class="co">#&gt; 5    5 5000 0 0 0 1.909157 0.5</span></span>
<span><span class="co">#&gt; 6    6 5000 0 0 0 1.883956 0.5</span></span></code></pre></div>
<p>We create a simple function to help us visualize the data we just
generated</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">build_SMILE_plots</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">smile_output_as_df</span>, <span class="va">facet_rows</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">smile_output_as_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">week</span>, names_to <span class="op">=</span> <span class="st">"compartment"</span>, values_to <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>compartment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">compartment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"M"</span>, <span class="st">"I"</span>, <span class="st">"L"</span>, <span class="st">"E"</span>, <span class="st">"Z"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">compartment</span>, scales <span class="op">=</span> <span class="st">"free"</span>, nrow <span class="op">=</span> <span class="va">facet_rows</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixed_vax_sim</span> <span class="op">|&gt;</span> <span class="fu">build_SMILE_plots</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="add_vax_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="section level2">
<h2 id="we-can-compare-this-to-variable-vaccination-rates">We can compare this to variable vaccination rates:<a class="anchor" aria-label="anchor" href="#we-can-compare-this-to-variable-vaccination-rates"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/smile_main.html">smile_main</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="va">my_b0</span>, b1 <span class="op">=</span> <span class="va">my_b1</span>, period <span class="op">=</span> <span class="va">my_outbreak_period</span>,</span>
<span>           theta <span class="op">=</span> <span class="va">my_theta</span>, tau <span class="op">=</span> <span class="va">my_tau</span>, years <span class="op">=</span> <span class="va">my_years</span>,</span>
<span>           vax <span class="op">=</span> <span class="va">my_yearly_vax</span>, beta_0 <span class="op">=</span> <span class="va">my_beta0</span>, beta_1 <span class="op">=</span> <span class="va">my_beta1</span>, output_df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">var_vax_sim</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">var_vax_sim</span><span class="op">)</span></span>
<span><span class="co">#&gt;   week    S M I L        E          Z</span></span>
<span><span class="co">#&gt; 1    1 5000 0 0 1 1.000000 0.02496662</span></span>
<span><span class="co">#&gt; 2    2 5000 0 0 0 1.986800 0.02496662</span></span>
<span><span class="co">#&gt; 3    3 5000 0 0 0 1.960574 0.02496662</span></span>
<span><span class="co">#&gt; 4    4 5000 0 0 0 1.934695 0.02496662</span></span>
<span><span class="co">#&gt; 5    5 5000 0 0 0 1.909157 0.02496662</span></span>
<span><span class="co">#&gt; 6    6 5000 0 0 0 1.883956 0.02496662</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_vax_sim</span> <span class="op">|&gt;</span> <span class="fu">build_SMILE_plots</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="add_vax_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>From this simulation we observe that with drops in vaccination, we
have a direct increase in the number of deaths and spores in the
environment.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by javi rudolph.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
